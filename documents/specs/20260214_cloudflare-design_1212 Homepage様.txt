# 1212 Homepage様 Specification

Date: 2026-02-14
Project: 1212ホームページ Cloudflare運用設計

## 1. 設計方針
- 公開サイトは既存資産を活かしつつ、運用負荷を増やさない構成を最優先とする
- 管理画面は本人専用とし、公開URLであっても認証なしでは利用できない状態にする
- ライブ情報更新とX投稿を同一フローで扱い、更新漏れ・告知漏れを防ぐ

## 2. 全体構成
- Public Web: 1212公式サイト（閲覧専用）
- Admin Web: 管理画面（本人専用、スマホ最適化）
- API Layer: データ更新API、投稿API、投稿履歴API
- Data Store: ライブ情報、ニュース、投稿キュー、投稿ログ
- External: X API（投稿先）

## 3. コンポーネント定義
### 3-1. 公開サイト
- ニュース、ライブ、ディスコグラフィー、プロフィールを表示
- 更新データはAPI経由または配信データ経由で反映
- 閲覧性能と可用性を優先

### 3-2. 管理画面
- 認証済みユーザーのみアクセス可能
- ニュース・ライブ情報を作成/更新/削除
- ライブ登録時に投稿前プレビューを表示
- 投稿実行、再実行、履歴確認を提供

### 3-3. API
- Content API: サイト表示用データ取得
- Admin API: 管理画面の保存・更新処理
- Post API: X投稿処理（即時/再実行）
- Health API: 監視用状態確認

### 3-4. データストア
- entities_live: ライブ情報（日時、会場、詳細、チケットURL、公開状態）
- entities_news: ニュース情報
- post_jobs: 投稿ジョブ（status, retry_count, last_error）
- post_logs: 実行履歴（実行日時、結果、投稿ID）

## 4. 認証・権限制御
- 管理画面は本人アカウント1名のみ許可
- APIは認証済みトークン前提で更新系を許可
- 公開データ取得APIは匿名アクセス許可

## 5. 投稿フロー（X）
1. 管理画面でライブ情報を保存
2. 投稿文テンプレートを自動生成しプレビュー表示
3. 管理者が投稿実行
4. 投稿APIがXへ送信
5. 成功時は投稿IDを保存、失敗時はエラー記録
6. 管理画面で再実行可能

## 6. 画面要件（管理画面）
- モバイルファーストの入力フォーム
- Upcoming / Past の切り替え管理
- 投稿対象フラグ（投稿済/未投稿）
- 投稿ステータス一覧（成功/失敗/再実行）

## 7. 運用設計
- 更新運用は「登録 -> プレビュー -> 投稿実行 -> 結果確認」を基本手順とする
- 障害時は再実行を優先し、継続失敗時は手動投稿に切替できる手順を持つ
- 投稿テンプレートは定期的に見直し、告知品質を維持する

## 8. リリース計画
- Phase 1: 管理画面Web公開 + 認証 + コンテンツ更新API
- Phase 2: ライブ登録時X投稿（手動実行トリガー）
- Phase 3: 投稿履歴・再実行・運用ダッシュボード
- Phase 4: Instagram連携検討

## 9. 非機能要件
- 管理画面はスマホで操作完了できる応答性
- 投稿失敗時に原因を把握できる可観測性
- 機密情報をクライアントへ露出しない構成

## 10. コスト方針
- 低頻度運用を前提に無料枠中心で構成
- API課金はX利用分を主対象とし、インフラ固定費は最小化
